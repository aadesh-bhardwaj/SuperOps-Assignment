{
  "Name": "auto-tagger-rule",
  "Description": "Triggers Lambda function to auto-tag newly created AWS resources",
  "EventPattern": {
    "source": [
      "aws.ec2",
      "aws.s3",
      "aws.rds",
      "aws.lambda",
      "aws.dynamodb",
      "aws.ecs",
      "aws.elasticloadbalancing",
      "aws.autoscaling",
      "aws.cloudformation"
    ],
    "detail-type": [
      "AWS API Call via CloudTrail"
    ],
    "detail": {
      "eventName": [
        "RunInstances",
        "CreateVolume",
        "CreateSnapshot",
        "CreateImage",
        "CreateSecurityGroup",
        "CreateVpc",
        "CreateSubnet",
        "CreateInternetGateway",
        "CreateNatGateway",
        "CreateBucket",
        "CreateDBInstance",
        "CreateDBCluster",
        "CreateFunction20150331",
        "CreateFunction20150331v2",
        "CreateTable",
        "CreateCluster",
        "CreateService",
        "CreateLoadBalancer",
        "CreateTargetGroup",
        "CreateAutoScalingGroup",
        "CreateStack",
        "AllocateAddress",
        "CreateNetworkInterface",
        "CreateRole"
      ]
    }
  },
  "State": "ENABLED",
  "Targets": [
    {
      "Arn": "arn:aws:lambda:REGION:ACCOUNT_ID:function:auto-tagger",
      "Id": "1"
    }
  ]
}
